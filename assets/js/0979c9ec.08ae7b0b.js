"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[194],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>b});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=i,b=u["".concat(c,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(b,o(o({ref:t},p),{},{components:n})):r.createElement(b,o({ref:t},p))}));function b(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:i,o[1]=s;for(var l=2;l<a;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2306:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var r=n(7462),i=(n(7294),n(3905));const a={sidebar_position:9},o="Services",s={unversionedId:"guide-to-dynamic-builds/services",id:"guide-to-dynamic-builds/services",title:"Services",description:"Services are processes that can be run alongside a Job to provide supporting capabilities while the Job runs.",source:"@site/docs/guide-to-dynamic-builds/services.md",sourceDirName:"guide-to-dynamic-builds",slug:"/guide-to-dynamic-builds/services",permalink:"/docs/guide-to-dynamic-builds/services",draft:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Fingerprints",permalink:"/docs/guide-to-dynamic-builds/fingerprints"},next:{title:"Real-World Example",permalink:"/docs/guide-to-dynamic-builds/example"}},c={},l=[{value:"Adding a Service",id:"adding-a-service",level:2},{value:"Service Execution",id:"service-execution",level:2},{value:"Service Definitions",id:"service-definitions",level:2}],p={toc:l},u="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"services"},"Services"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Services")," are processes that can be run alongside a Job to provide supporting capabilities while the Job runs.\nFor example, a database service could be used to allow a Job that runs tests to interact with the database\nwhile the tests run."),(0,i.kt)("p",null,"Each Job can specify any number of Services to run. All Services will be started before the Job's\nfirst Step command is run, and will continue to run until all Steps within the Job have completed."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Services are not available when fingerprint commands are run; if a fingerprint is the same as\na previous build, causing the Job to be skipped, the Job's Services will not be started.)")),(0,i.kt)("h2",{id:"adding-a-service"},"Adding a Service"),(0,i.kt)("p",null,"The workflow handler function adds a Service to a Job by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"NewService()")," to create a\n",(0,i.kt)("em",{parentName:"p"},"Service object"),", then calling the Job's ",(0,i.kt)("inlineCode",{parentName:"p"},"Service()")," method to attach the Service.\nProperties are set on the Service by calling methods on the object."),(0,i.kt)("p",null,"Here's an example (in Go) of a Job making use of a Service:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'    w.Job(bb.NewJob().\n        Name("test-job").\n        Docker(bb.NewDocker().Image("docker:20.10").Pull(bb.DockerPullIfNotExists)).\n        Step(bb.NewStep().\n            Name("first-step").\n            Commands("echo This step can make use of the postgres server")).\n        Service(bb.NewService().\n            Name("postgres").\n            Image("postgres:14").\n            Env(bb.NewEnv().\n                Name("POSTGRES_USER").\n                Value("user-name")).\n            Env(bb.NewEnv().\n                Name("POSTGRES_PASSWORD").\n                Value("use-secrets-dont-put-password-here"))))\n        ))\n')),(0,i.kt)("h2",{id:"service-execution"},"Service Execution"),(0,i.kt)("p",null,"All services must currently be executed by running a Docker Container; native services are not yet supported.\nEach service is started by starting its Docker container, and stopped by stopping the Docker container;\nthe container itself is responsible for running any commands required to provide the service."),(0,i.kt)("p",null,"Each service gets to specify its own Docker image and environment variables, independently of the Job it is\nattached to."),(0,i.kt)("h2",{id:"service-definitions"},"Service Definitions"),(0,i.kt)("p",null,"The following methods are available to set properties on a Service:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Name")," (mandatory): a name to use when referencing the service, unique within the Job.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Image")," (mandatory): specifies the name of the Docker image to use when running this Service.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Env")," (optional): specifies an environment variable that should be passed to the Docker container that runs\nthe Service. The Env() method can be called multiple times to add multiple variables. Environment variables\nare defined in the same way as for Jobs, and ",(0,i.kt)("a",{parentName:"p",href:"jobs#secrets"},"Secrets")," can be used; for details please see the Job\n",(0,i.kt)("a",{parentName:"p",href:"jobs#environment-variables"},"Environment Variables")," section.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"BasicAuth")," (optional): configures Basic Authentication credentials for the Docker registry, to use when\nfetching the Docker image. Takes a BasicAuth object to specify the username and password\nfor authentication; see\n",(0,i.kt)("a",{parentName:"p",href:"docker-configuration#authentication-for-docker-registries"},"Authentication for Docker Registries")," for details.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"AWSAuth")," (optional): configures AWS Authentication credentials for Amazon ECR, to use when fetching the Docker\nimage. Takes an AWSAuth object to specify the details for authentication; see\n",(0,i.kt)("a",{parentName:"p",href:"docker-configuration#authentication-for-docker-registries"},"Authentication for Docker Registries")," for details."))))}d.isMDXComponent=!0}}]);